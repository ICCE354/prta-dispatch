<script>
const scheduleData = [
  { stop:"Main St", time:"08:30", arrived:false },
  { stop:"Broadway", time:"08:42", arrived:false }
];

function renderSchedule(){
  const t = document.getElementById("sched");
  t.innerHTML = `
    <tr>
      <th>STOP</th>
      <th>TIME</th>
      <th>STATUS</th>
    </tr>
  `;

  scheduleData.forEach((s,i)=>{
    const r = t.insertRow();
    r.insertCell().innerText = s.stop;
    r.insertCell().innerText = s.time;

    const statusCell = r.insertCell();

    if(!s.arrived){
      statusCell.innerHTML =
        `<button style="width:100%;padding:6px"
          onclick="arrive(${i})">ARRIVED</button>`;
    } else {
      statusCell.innerText = s.statusText;
    }
  });
}

function arrive(index){
  const s = scheduleData[index];

  const now = new Date();
  const [h,m] = s.time.split(":").map(Number);
  const sched = new Date();
  sched.setHours(h,m,0,0);

  const diff = Math.round((now - sched) / 60000);

  let status = "ON TIME";
  if(diff > 1) status = `LATE +${diff} MIN`;
  if(diff < -1) status = `EARLY ${Math.abs(diff)} MIN`;

  s.arrived = true;
  s.statusText = status;

  renderSchedule();
  updateFooter();
}

function updateFooter(){
  const next = scheduleData.find(s=>!s.arrived);
  if(!next){
    footer.classList.remove("late");
    statusText.innerText = "TRIP COMPLETE";
    return;
  }

  const [h,m] = next.time.split(":").map(Number);
  const sched = new Date();
  sched.setHours(h,m,0,0);

  const now = new Date();
  const diff = Math.round((now - sched) / 60000);

  if(diff > 1){
    footer.classList.add("late");
    statusText.innerText = `LATE ${diff} MIN`;
  } else {
    footer.classList.remove("late");
    statusText.innerText = "SYSTEMS OK";
  }
}

renderSchedule();
setInterval(updateFooter,5000);
</script>


