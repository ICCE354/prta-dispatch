<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PRTA MDT</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:#9fd3ff;
  color:white;
}
button,select,input,textarea{
  font-weight:bold;
  padding:8px;
}
button{cursor:pointer}

/* ===== LOGIN ===== */
#loginPage{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.loginBox{
  width:360px;
  padding:30px;
  background:#0b2e63;
  border-radius:10px;
}
.loginBox input{
  width:100%;
  margin-bottom:12px;
  padding:14px;
}
.loginBox button{
  width:100%;
  background:#1e88e5;
  border:none;
  color:white;
  padding:14px;
}

/* ===== PAGES ===== */
.page{display:none}
.topBar{
  background:#0b2e63;
  padding:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.content{
  padding:15px;
  background:#0a2a5c;
  min-height:calc(100vh - 60px);
}
.panel{
  background:#103b7a;
  border:2px solid #5fb0ff;
  padding:10px;
  margin-bottom:15px;
}

/* ===== TABLE ===== */
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border:1px solid #5fb0ff;
  padding:6px;
  text-align:center;
}
th{background:#123d7a}

/* ===== MESSAGE STATUS ===== */
.pending{background:#7c2d12}
.ack{background:#0f7a3c}
.msgBox{
  max-height:200px;
  overflow-y:auto;
  font-size:14px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage">
  <div class="loginBox">
    <h2>PRTA Login</h2>
    <input id="username" placeholder="Username">
    <input id="password" type="password" placeholder="Password">
    <button onclick="login()">LOGIN</button>
  </div>
</div>

<!-- DRIVER -->
<div id="driverPage" class="page">
  <div class="topBar">
    <strong>DRIVER MDT</strong>
    <button onclick="logout()">LOG OUT</button>
  </div>
  <div class="content">
    <div class="panel">
      <h3>Send Message to Dispatch</h3>
      <button onclick="sendDriverMsg('Running Late')">Running Late</button>
      <button onclick="sendDriverMsg('Traffic Delay')">Traffic Delay</button>
      <button onclick="sendDriverMsg('Mechanical Issue')">Mechanical Issue</button>
      <button onclick="sendDriverMsg('Operator Assistance Requested')">Operator Assistance Requested</button>
      <button onclick="sendDriverMsg('Customer Declined Shoulder Strap')">
        Customer Declined Shoulder Strap
      </button>
    </div>

    <div class="panel">
      <h3>Messages from Dispatch</h3>
      <div class="msgBox" id="driverInbox"></div>
    </div>
  </div>
</div>

<!-- DISPATCHER -->
<div id="dispatcherPage" class="page">
  <div class="topBar">
    <strong>DISPATCHER</strong>
    <button onclick="logout()">LOG OUT</button>
  </div>
  <div class="content">

    <div class="panel">
      <h3>Send Message to Driver</h3>
      <select id="dispatchDriver">
        <option value="3675">3675</option>
        <option value="3804">3804</option>
      </select>
      <textarea id="dispatchText" rows="3" placeholder="Type message"></textarea>
      <button onclick="sendDispatchMsg()">SEND</button>
    </div>

    <div class="panel">
      <h3>Driver Messages</h3>
      <table id="dispatchMsgs"></table>
    </div>

  </div>
</div>

<!-- SUPERVISOR -->
<div id="supervisorPage" class="page">
  <div class="topBar">
    <strong>SUPERVISOR</strong>
    <button onclick="logout()">LOG OUT</button>
  </div>
  <div class="content">
    <div class="panel">
      <h3>All Messages</h3>
      <div class="msgBox" id="supervisorInbox"></div>
    </div>
  </div>
</div>

<script>
/* USERS */
const users={
  "3675":{password:"SR",role:"driver"},
  "3804":{password:"ER",role:"driver"},
  "dispatcher":{password:"admin",role:"dispatcher"},
  "supervisor":{password:"super",role:"supervisor"}
};

let currentUser=null;
let messages=[];

/* LOGIN */
function login(){
  const u=username.value.trim();
  const p=password.value.trim();
  if(!users[u]||users[u].password!==p){alert("Invalid login");return;}
  currentUser={name:u,role:users[u].role};
  loginPage.style.display="none";
  if(currentUser.role==="driver") driverPage.style.display="block";
  if(currentUser.role==="dispatcher") dispatcherPage.style.display="block";
  if(currentUser.role==="supervisor") supervisorPage.style.display="block";
  renderMessages();
}
function logout(){location.reload();}

/* DRIVER SEND */
function sendDriverMsg(text){
  messages.push({
    from:currentUser.name,
    to:"dispatch",
    text,
    time:new Date().toLocaleTimeString(),
    status:"Pending"
  });
  renderMessages();
}

/* DISPATCH SEND */
function sendDispatchMsg(){
  if(!dispatchText.value)return;
  messages.push({
    from:"dispatch",
    to:dispatchDriver.value,
    text:dispatchText.value,
    time:new Date().toLocaleTimeString(),
    status:"Sent"
  });
  dispatchText.value="";
  renderMessages();
}

/* ACK */
function acknowledge(i){
  messages[i].status="Acknowledged";
  renderMessages();
}

/* RENDER */
function renderMessages(){
  /* DRIVER INBOX */
  if(driverInbox){
    driverInbox.innerHTML="";
    messages.filter(m=>m.to===currentUser?.name)
      .forEach(m=>{
        driverInbox.innerHTML+=
          `<div>[${m.time}] ${m.text}</div>`;
      });
  }

  /* DISPATCH TABLE */
  if(dispatchMsgs){
    dispatchMsgs.innerHTML="<tr><th>Driver</th><th>Message</th><th>Status</th></tr>";
    messages.filter(m=>m.to==="dispatch").forEach((m,i)=>{
      const r=dispatchMsgs.insertRow();
      r.className=m.status==="Pending"?"pending":"ack";
      r.insertCell().innerText=m.from;
      r.insertCell().innerText=`${m.text} (${m.time})`;
      r.insertCell().innerHTML=
        m.status==="Pending"
        ? `<button onclick="acknowledge(${i})">ACK</button>`
        : "Acknowledged";
    });
  }

  /* SUPERVISOR */
  if(supervisorInbox){
    supervisorInbox.innerHTML="";
    messages.forEach(m=>{
      supervisorInbox.innerHTML+=
        `<div>[${m.time}] ${m.from} â†’ ${m.to}: ${m.text} (${m.status})</div>`;
    });
  }
}
</script>

</body>
</html>

